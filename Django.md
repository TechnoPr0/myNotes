## **Основные команды для начала работы:**

```sudo apt-get install python3-pip``` - установка инсталятора пакетов python.

```pip3 list```- Отображение установленных пакетов

___
## **Создание и использование виртуальной среды:**

```sudo pip3 install virtualenvwrapper``` - установка виртуальной среды (что бы устанавливать пакеты только для конкретного проекта, не затрагивая остальные).

Затем добавьте следующие строки в конец файла загрузки программной оболочки (shell) (это скрытый файл в вашей домашней директории с именем .bashrc). Они устанавливают расположение виртуальных сред, расположение каталога разрабатываемого проекта и расположение установленного с этим пакетом скрипта. 

```
export WORKON_HOME=$HOME/.virtualenvs
export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3
export VIRTUALENVWRAPPER_VIRTUALENV_ARGS=' -p /usr/bin/python3 '
export PROJECT_HOME=$HOME/Devel
source /usr/local/bin/virtualenvwrapper.sh
```

Затем перезагрузите файл загрузки, выполнив в терминале следующую команду:

```source ~/.bashrc```

В этот момент вы должны увидеть запуск группы скриптов, как показано ниже:

```virtualenvwrapper.user_scripts creating /home/ubuntu/.virtualenvs/premkproject
virtualenvwrapper.user_scripts creating /home/ubuntu/.virtualenvs/postmkproject
...
virtualenvwrapper.user_scripts creating /home/ubuntu/.virtualenvs/preactivate
virtualenvwrapper.user_scripts creating /home/ubuntu/.virtualenvs/postactivate
virtualenvwrapper.user_scripts creating /home/ubuntu/.virtualenvs/get_env_details
```

```mkvirtualenv``` имя_среды - Теперь вы можете создать новую виртуальную среду при помощи этой команды.

```deactivate``` — Выход из текущей виртуальной среды Python
```workon``` — Список доступных виртуальных сред
```workon имя_среды``` — Активация конкретной виртуальной среды Python
```rmvirtualenv``` имя_среды — Удаление конкретной виртуальной среды.

___
## **Установка Django.**

```pip3 install django``` - Установка пакета Django.

```mkdir имя_проекта``` - Создание папки проекта.

```cd имя_проекта``` - переход в папку проекта.

```django-admin startproject имя_проекта``` - Создание проекта на Django

```cd имя_проекта``` - Переход в папку проекта

```python3 manage.py runserver``` - Запуск сервера возможны дополнительные параметры в виде адреса сервера и порта, после можно проверить запуск сервера по адресу http://127.0.0.1:8000/

___
## **Создание приложений.**

```python3 manage.py startapp имя_приложения``` - Создание приложения

Дальше нужно зарегистрировать приложение, для этого нужно в файле settings.py основной папки, добавить в конец списока INSTALLED_APPS строку:

```'имя_приложения.apps.Имя_приложенияConfig',``` 

Обратите внимание, что после apps. нужно написать Имя_приложения с большой буквы т.к. это созданный класс, его можной найти в файле apps.py соответствующего приложения.

Пример:
Если мы назвали приложене - catalog , то выглядеть это должно так:

```
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'catalog.apps.CatalogConfig', 
]
```
Настройка базы данных.
	Настройка базы данных происходит всё в том же файле настроек settings.py . В списке DATABASES.
	Если будет использоваться база данных SQLite , то ничего делать не нужно она настроена по умолчанию:

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    }
}
```
Если же нам нужно использовать другую базу данных то список нужно будет изменить.

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.тип_базы_данных',
        'NAME': 'имя_базы',
        'USER': 'имя_пользователя_базы',
        'PASSWORD': 'пароль_базы',
        'HOST': 'адрес_хоста', # в локалке не обязательно
        'PORT': 'порт', # в локалке не обязательно
    }
}
```

ENGINE

Используемый механизм базы данных. В Django встроены следующие движки баз данных:

```
'django.db.backends.postgresql'
'django.db.backends.mysql'
'django.db.backends.sqlite3'
'django.db.backends.oracle'
```

NAME

Имя используемой базы данных. Для SQLite это полный путь к файлу базы данных. Когда путь указан, всегда используйте косую черту, даже в Windows (например C:/homes/user/mysite/sqlite3.db ).

USER 

Имя пользователя для использования при подключении к базе данных. Не используется с SQLite.

PASSWORD

Пароль для использования при подключении к базе данных. Не используется с SQLite.

HOST

Хост, используемый при подключении к базе данных. Пустая строка означает localhost . Не используется с SQLite.
Если это значение начинается с косой черты ( '/' ) и вы используете MySQL, MySQL будет подключаться через соединитель Unix к указанному соединителю. Например :

```"HOST": '/var/run/mysql'```

Если вы используете MySQL и это значение не начинается с косой черты, Django предполагает, что это значение host.
Если вы используете PostgreSQL, по умолчанию ( HOST пусто) соединение с базой данных осуществляется через соединители Unix («локальные» строки в pg_hba.conf ). Если ваш коннектор домена UNIX не находится в стандартном месте, используйте то же значение, unix_socket_directory что и postgresql.conf . Если вы предпочитаете подключаться через TCP-коннекторы, установите HOST «localhost» или «127.0.0.1» (строчки «host» в pg_hba.conf ). В Windows вам все равно нужно установить HOST , поскольку соединители домена Unix недоступны.

PORT

Порт, используемый при подключении к базе данных. Пустая строка означает порт по умолчанию. Не используется с SQLite.



___
## **Установка базы данных MySql.**

### Для Linux(Ubuntu):

Прежде чем устанавливать Mysql в Django, ей нужно установить и настроить в самой ОС:

```sudo apt update``` - Обновляем списки пакетов.

```sudo apt install mysql-server mysql-client``` - устанавливаем необходимые пакеты.

```mysql -V``` - можно проверить версию

```sudo systemctl status mysql``` - Проверить запущена ли сдужба mysql (должно зелёным цветом писать active(running)

```sudo mysql_secure_installation``` - скрипт для первоначальной настройки
На первом шаге настраивается плагин валидации пароля можно отказаться (n), но если нажмёте y - предложат задать сложность пароля 0 - слабый, 2 - сложный
Дальше предлагают задать пароль для root
дальше ряд вопросов - 
Отключение анонимного доступа;
Запрет удалённого доступа от имени root
Удалять ли тестовую базу
Обновлять ли привелегии для пользователей


```sudo mysql -u root``` - подключение к серверу баз данных

```CREATE DATABASE testDB;``` - создание имени базы

```CREATE USER 'my_user'@'localhost' IDENTIFIED BY 'password';``` - создание пользователя и пароля.

```GRANT ALL PRIVILEGES ON testDB.* TO 'my_user'@'localhost';```  - присваивание пользователю всех привелегий

```FLUSH PRIVILEGES;``` - после манипуляций с правами их нужно сохранить.

```SELECT user,host FROM mysql.user;```- можно проверить список пользователей в БД.

```SHOW GRANTS FOR 'my_user'@'localhost';``` - проверить полномочия пользователя

```CREATE DATABASE testDB;``` - создание имени базы

```CREATE USER 'my_user'@'localhost' IDENTIFIED BY 'password';``` - создание пользователя и пароля.

```GRANT ALL PRIVILEGES ON testDB.* TO 'my_user'@'localhost';```  - присваивание пользователю всех привелегий

```FLUSH PRIVILEGES;```- после манипуляций с правами их нужно сохранить.

```SELECT user,host FROM mysql.user;``` - можно проверить список пользователей в БД.

```SHOW GRANTS FOR 'my_user'@'localhost';```- проверить полномочия 



Дальше у меня был затык т.к. не мог установить клиент с помощью pip, пока на одном из форумов не нашёл ссылку: https://pypi.org/project/mysqlclient/

	Следующее решение для ubuntu  как раз оттуда:
```$ sudo apt-get install python3-dev default-libmysqlclient-dev build-essential```

А потом уже устанавливаем клиент через PIP

```$ pip3 install mysqlclient```

Ещё было что при запуске виртуальной машины mysql server не запускался. Запустить его можно командой:

```$ sudo service mysql start```


___

## **Другие настройки проекта**


Файл settings.py так же применяется и для некоторых других настроек, но на данном шаге имеет смысл поменять разве что TIME_ZONE — это значение должно быть представлено строкой, указанной в списке часовых поясов tz (колонка TZ в таблице, в строке временной зоны, которая вам нужна). Измените TIME_ZONE на одну из строк из таблицы, которая отвечает вашему часовому поясу. Например:

```TIME_ZONE = 'Europe/Moscow'```

В файле присутствует две настройки, которые не нужно менять сейчас, но о назначении которых следует знать:

```SECRET_KEY``` - Это секретный ключ, который используется Django для поддержки безопасности сайта. Если вы раскроете этот ключ в процессе разработки кому-либо, то необходимо будет его сменить (возможно считать его с какого-либо файла на сервере или переменной окружения) когда будете размещать проект на сервер. 

```DEBUG``` - Включает подробные сообщения об ошибках, вместо стандартных HTTP статусов ответов. Должно быть изменено на False на сервере, так как эта информация очень много расскажет взломщикам. 

___
## **Создание супер юзера.**

```python manage.py createsuperuser```- Создание суперюзера.

___
## **Создание моделей.**

Создание моделей происходит в файле models.py нашего приложения. 

Пример модели:

class Category(models.Model):
	title = models.Charfield(“Наименование категории”, max_length=255)

class Product(models.Model):
	title = models.CharField("Наименование", max_length=255)
    	description = models.TextField("Описание")
 	models.PositiveIntegerField = ("Цена")
  	categories = modelsForeignKey(Category, on_delete=models.CASCADE)

## **Типы полей.**

+ ```CharField```

    class CharField(max_length=None, **options)

    Строковое поле, для строк малого и большого размера.
    Для больших объемов текста используйте TextField.
    Виджет формы по умолчанию для этого поля TextInput.
    CharField имеет два дополнительных аргумента:

+ ```CharField.max_length``` 

    Необходимый. Максимальная длина (в символах) поля. max_length применяется на уровне базы данных и при проверке Django с использованием MaxLengthValidator.

+ ```CharField.db_collation``` 

     Необязательный. Имя поля сортировки базы данных.

+ ```DateField```

    class DateField(auto_now=False, auto_now_add=False, **options)

    Дата, представленная в Python экземпляром datetime.date. Имеет несколько дополнительных необязательных аргументов:

+ ```DateField.auto_now```

    Автоматически устанавливать текущую дату каждый раз, когда объект сохраняется. Полезно для отметок времени последнего изменения. Обратите внимание, что текущая дата всегда используется; это не просто значение по умолчанию, которое вы можете переопределить. Поле автоматически обновляется только при вызове Model.save(). Поле не обновляется при обновлении других полей другими способами, такими как QuerySet.update(), хотя вы можете указать пользовательское значение для поля в обновлении, как это.

+ ```DateField.auto_now_add```

    Автоматически установить поле на сейчас, когда объект создается впервые. Полезно для создания меток времени. Обратите внимание, что текущая дата всегда используется; это не просто значение по умолчанию, которое вы можете переопределить. Так что даже если вы установите значение для этого поля при создании объекта, оно будет проигнорировано. Если вы хотите изменить это поле, установите вместо auto_now_add=True следующее:
    Для DateField: default=date.today - от datetime.date.today()
    Для DateTimeField: default=timezone.now - от django.utils.timezone.now()
    Виджет формы по умолчанию для этого поля TextInput. В админке добавляется календарь JavaScript и ярлык для «Сегодня». Включает в себя дополнительный invalid_date ключ сообщения об ошибке.
    Опции auto_now_add, auto_now и default являются взаимоисключающими. Любая комбинация этих параметров приведет к ошибке.  
    
    ***Примечание:***
    Как в настоящее время реализовано, установка auto_now или auto_now_add в True приведет к тому, что в поле будут установлены editable=False и blank=True.

    **Примечание:**
    Опции auto_now и auto_now_add всегда будут использовать дату в часовом поясе по умолчанию в момент создания или обновления. Если вам нужно что-то другое, вы можете рассмотреть возможность использования собственной функции вызываемой по умолчанию или переопределения save() вместо использования auto_now или auto_now_add; или используя DateTimeField вместо `` DateField`` и решая, как обрабатывать преобразование из даты-времени в дату во время отображения.

+ ```DateTimeField```

    class DateTimeField(auto_now=False, auto_now_add=False, **options)

    Дата и время, представленные в Python экземпляром datetime.datetime. Принимает те же дополнительные аргументы, что и DateField.
    Виджет формы по умолчанию для этого поля это TextInput. Админка использует два отдельных виджета TextInput с ярлыками JavaScript.

+ ```PositiveBigIntegerField```

    class PositiveBigIntegerField(**options)

    Как a: class: PositiveIntegerField, но допускает значения только в определенной (зависящей от базы данных) точке. Значения от  "0" до  "9223372036854775807" безопасны во всех базах данных, поддерживаемых Django.

+ ```PositiveIntegerField```

    class PositiveIntegerField(**options)

    Подобно IntegerField, но должно быть либо положительным, либо нулевым (0). Значения от 0 до 2147483647 безопасны во всех базах данных, поддерживаемых Django. Значение 0 принимается по причинам обратной совместимости.```

+ ```PositiveSmallIntegerField```

    class PositiveSmallIntegerField(**options)

    Как и PositiveIntegerField, но допускает значения только в определенной (зависящей от базы данных) точке. Значения от 0 до 32767 безопасны во всех базах данных, поддерживаемых Django.

+ ```SlugField```

    class SlugField(max_length=50, **options)
    
    Slug - газетный термин. Слаг - это короткая метка для чего-либо, содержащая только буквы, цифры, подчеркивания или дефисы. Они обычно используются в URL.
    Как и в случае CharField, вы можете указать max_length (читайте заметку о переносимости базы данных и max_length в этом разделе). Если max_length не указан, Django будет использовать длину по умолчанию 50.
    Подразумевает установку Field.db_index в True.
    Часто полезно автоматически предварительно заполнить поле SlugField на основе значения некоторого другого значения. Вы можете сделать это автоматически в админке, используя prepopulated_fields.
    Он использует validate_slug или validate_unicode_slug для проверки.

+ ```SlugField.allow_unicode```

    Если True, поле принимает символы Unicode в дополнение к символам ASCII. По умолчанию False.


+ ```AutoField```

    class AutoField(**options)

    IntegerField, который автоматически увеличивается в соответствии с доступными идентификаторами. Вам обычно не нужно использовать это напрямую; поле первичного ключа будет автоматически добавлено в вашу модель, если вы не укажете иное. Смотрите: ref: automatic-primary-key-fields.

+ ```BigAutoField```
    class BigAutoField(**options)

    64-разрядное целое число, очень похожее на AutoField, за исключением того, что оно гарантированно соответствует числам от 1 до 9223372036854775807.

+ ```BigIntegerField```
    class BigIntegerField(**options)

    64-разрядное целое число, очень похожее на IntegerField, за исключением того, что оно гарантированно соответствует числам от -9223372036854775808 до 9223372036854775807. Виджет формы по умолчанию для этого поля TextInput.

+ ```BinaryField```

    class BinaryField(max_length=None, **options)

    Поле для хранения необработанных двоичных данных. Может быть назначено bytes, bytearray или memoryview.
    По умолчанию BinaryField устанавливает editable в False, и в этом случае он не может быть включен в ModelForm.
    BinaryField имеет один дополнительный необязательный аргумент:
    BinaryField.max_length

    Злоупотребление BinaryField
    Хотя вы можете подумать о хранении файлов в базе данных, учтите, что это плохой дизайн в 99% случаев. Это поле не замена для правильной обработки статических файлов.

+ ```BooleanField```
    
    class BooleanField(**options)
    
    Поле истина/ложь.
    Виджет формы по умолчанию для этого поля CheckboxInput или NullBooleanSelect если null=True.
    Значение по умолчанию BooleanField равно None, когда Field.default не определено.


+ ```DecimalField```

    class DecimalField(max_digits=None, decimal_places=None, **options)

    Десятичное число с фиксированной точностью, представленное в Python экземпляром Decimal. Он проверяет ввод с помощью DecimalValidator.

    Имеет два обязательных аргумента:

+ ```DecimalField.max_digits```

    Максимально допустимое количество цифр в номере. Обратите внимание, что это число должно быть больше или равно decimal_places.

+ ```DecimalField.decimal_places```

    Количество десятичных разрядов для хранения с числом.
    Например, чтобы хранить числа до 999 с разрешением в 2 десятичных знака, вы должны использовать:

    models.DecimalField(..., max_digits=5, decimal_places=2)

    И хранить цифры примерно до миллиарда с разрешением 10 десятичных знаков:

    models.DecimalField(..., max_digits=19, decimal_places=10)

    Виджетом формы по умолчанию для этого поля является NumberInput, когда localize False или TextInput в противном случае.

    **Примечание:**
    Для получения дополнительной информации о различиях между классами FloatField и DecimalField, пожалуйста, смотрите FloatField или DecimalField. Вы также должны ознакомиться с ограничения SQLite для десятичных полей.

+ ```DurationField```

    class DurationField(**options)

    Поле для хранения периодов времени - смоделировано в Python с помощью datetime.timedelta. При использовании в PostgreSQL используемый тип данных представляет собой interval, а в Oracle тип данных представляет собой INTERVAL DAY (9) TO SECOND (6). В противном случае используется bigint микросекунд.

    **Примечание:**
    Арифметика с DurationField работает в большинстве случаев. Однако во всех базах данных, кроме PostgreSQL, сравнение значения DurationField с арифметикой в экземплярах DateTimeField не будет работать должным образом.

+ ```EmailField```

    class EmailField(max_length=254, **options)

    Класс CharField, который проверяет, является ли значение действительным адресом электронной почты, используя EmailValidator.

+ ```FileField```

    class FileField(upload_to=None, max_length=100, **options)

    Поле для загрузки файла.

    **Примечание:**
    Аргумент primary_key не поддерживается и выдает ошибку, если используется.

    Имеет два необязательных аргумента:

    ```FileField.upload_to``` - Этот атрибут обеспечивает способ указания каталога загрузки и имени файла и может быть установлен двумя способами. В обоих случаях значение передается методу Storage.save().
    Если указать строковое значение или Path, оно может содержать форматирование strftime(), которое будет заменено датой/временем загрузки файла (чтобы загруженные файлы не заполняли заданный каталог). **Например:**

    ```
    class MyModel(models.Model):
    # file will be uploaded to MEDIA_ROOT/uploads
    upload = models.FileField(upload_to='uploads/')
    # or...
    # file will be saved to MEDIA_ROOT/uploads/2015/01/30
    upload = models.FileField(upload_to='uploads/%Y/%m/%d/')
    ```
    Если вы используете по умолчанию FileSystemStorage, строковое значение будет добавлено к вашему пути MEDIA_ROOT, чтобы сформировать местоположение в локальной файловой системе, где будут находиться загруженные файлы. Если вы используете другое хранилище, проверьте документацию этого хранилища, чтобы увидеть, как оно обрабатывает upload_to.
    upload_to также может быть вызываемым объектом, например, функцией. Он будет вызван для получения пути загрузки, включая имя файла. Этот вызываемый объект должен принимать два аргумента и возвращать путь в стиле Unix (с косой чертой) для передачи в систему хранения. Два аргумента:
    instance - Экземпляр модели, где определено FileField. Более конкретно, это случай, когда текущий файл присоединяется.
    В большинстве случаев этот объект еще не был сохранен в базе данных, поэтому, если он использует значение по умолчанию AutoField, *он может еще не иметь значения для своего поля первичного ключа *.
    filename - Имя файла, которое изначально было указано в файле. Это может или не может быть принято во внимание при определении окончательного пути назначения. 
    **Например:**

    ```
    def user_directory_path(instance, filename):
        # file will be uploaded to MEDIA_ROOT/user_<id>/<filename>
        return 'user_{0}/{1}'.format(instance.user.id, filename)

    class MyModel(models.Model):
        upload = models.FileField(upload_to=user_directory_path)
    ```   

    ```FileField.storage```

    Объект хранения или вызываемый объект, который возвращает объект хранения. Обрабатывает хранение и поиск ваших файлов. Смотрите Управление файлами для получения подробной информации о том, как предоставить этот объект.
    Виджетом формы по умолчанию для этого поля является ClearableFileInput.
    Использование FileField или ImageField (см. ниже) в модели требует нескольких шагов:

    In your settings file, you’ll need to define MEDIA_ROOT as the full path to a directory where you’d like Django to store uploaded files. (For performance, these files are not stored in the database.) Define MEDIA_URL as the base public URL of that directory. Make sure that this directory is writable by the web server’s user account.
    Добавьте FileField или ImageField к вашей модели, определив параметр upload_to, чтобы указать подкаталог MEDIA_ROOT, который будет использоваться для загружаемых файлов.
    Все, что будет храниться в вашей базе данных, это путь к файлу (относительно MEDIA_ROOT). Вы, скорее всего, захотите использовать url, предоставленный Django. Например, если ваш ImageField называется mug_shot, вы можете получить абсолютный путь к вашему изображению в шаблоне с помощью {{ object.mug_shot.url }}.

    Например, скажем, что ваш параметр MEDIA_ROOT установлен в '/home/media', а для upload_to установлен 'photos/%Y/%m/%d'. Часть '%Y/%m/%d' в upload_to имеет форматирование strftime(); '%Y' - четырехзначный год, '%m' - двузначный месяц, а '% d' - двузначный день. Если вы загрузите файл 15 января 2007 года, он будет сохранен в каталоге /home/media/photos/2007/01/15.
    Если вы хотите получить имя файла загруженного файла на диске или размер файла, вы можете использовать атрибуты name и File соответственно; для получения дополнительной информации о доступных атрибутах и методах см. File и руководство по темам Управление файлами.

    **Примечание:**
    Файл сохраняется как часть сохранения модели в базе данных, поэтому фактическое имя файла, используемое на диске, не может быть определено до тех пор, пока модель не будет сохранена.

    Относительный URL загруженного файла можно получить с помощью атрибута url. Внутренне это вызывает метод url() базового класса Storage.

    Note that whenever you deal with uploaded files, you should pay close attention to where you’re uploading them and what type of files they are, to avoid security holes. Validate all uploaded files so that you’re sure the files are what you think they are. For example, if you blindly let somebody upload files, without validation, to a directory that’s within your web server’s document root, then somebody could upload a CGI or PHP script and execute that script by visiting its URL on your site. Don’t allow that.
    Также обратите внимание, что даже загруженный файл HTML, поскольку он может выполняться браузером (но не сервером), может создавать угрозы безопасности, эквивалентные атакам XSS или CSRF.
    Экземпляры FileField создаются в вашей базе данных как varchar столбцы с максимальной длиной по умолчанию 100 символов. Как и в других полях, вы можете изменить максимальную длину, используя аргумент max_length.

    ```FileField и FieldFile class FieldFile```

    Когда вы обращаетесь к FileField в модели, вам предоставляется экземпляр FieldFile в качестве прокси для доступа к базовому файлу.
    API класса FieldFile отражает интерфейс класса File, с одним ключевым отличием: Объект, обернутый классом, не обязательно является оберткой вокруг встроенного в Python файлового объекта. Вместо этого он является оберткой вокруг результата метода Storage.open(), который может быть File, или это может быть реализация пользовательского хранилища API File.
    В дополнение к API, унаследованному от File, такого как read()``и ``write(), FieldFile включает в себя несколько методов, которые могут использоваться для взаимодействия с базовым файлом:

    Предупреждение
    Два метода этого класса save() и delete(), по умолчанию сохраняют объект модели связанного FieldFile в базе данных.

    ```FieldFile.name```

    Имя файла, включая относительный путь от корня Storage связанного FileField.

    FieldFile.path
    Доступное только для чтения свойство для доступа к пути файла в локальной файловой системе путем вызова метода path() базового класса Storage.

    FieldFile.size
    Результат базового метода Storage.size().

    ```FieldFile.url```

    Доступное только для чтения свойство для доступа к относительному URL-адресу файла путем вызова метода url() базового класса Storage.

    ```FieldFile.open(mode='rb')```

    Открывает или повторно открывает файл, связанный с этим экземпляром, в указанном режиме mode. В отличие от стандартного метода open() Python, он не возвращает файловый дескриптор.

    Поскольку базовый файл открывается неявно при доступе к нему, может не быть нужным вызывать этот метод, кроме как для сброса указателя на базовый файл или для изменения mode.

    ```FieldFile.close()```
    Ведет себя как стандартный метод file.close() Python и закрывает файл, связанный с этим экземпляром.

    ```FieldFile.save(name, content, save=True)```
    Этот метод берет имя файла и содержимое файла и передает их в класс хранения для поля, а затем связывает сохраненный файл с полем модели. Если вы хотите вручную связать данные файла с экземплярами FileField в вашей модели, метод save() используется для сохранения этих данных файла.
    Принимает два обязательных аргумента: name, который является именем файла, и content, который является объектом, содержащим содержимое файла. Необязательный аргумент save управляет сохранением экземпляра модели после изменения файла, связанного с этим полем. По умолчанию True.
    Обратите внимание, что аргумент content должен быть экземпляром django.core.files.File, а не встроенным файловым объектом Python. Вы можете создать File из существующего объекта файла Python, **например:**

    ```
    from django.core.files import File
    # Open an existing file using Python's built-in open()
    f = open('/path/to/hello.world')
    myfile = File(f)
    ```
    
    Или вы можете построить один из строки Python, как здесь:

    ```
    from django.core.files.base import ContentFile
    myfile = ContentFile("hello world")
    ```

    ```FieldFile.delete(save=True)```
    Удаляет файл, связанный с этим экземпляром, и очищает все атрибуты в поле. Примечание. Этот метод закрывает файл, если он открывается при вызове delete().

    Необязательный аргумент save определяет, будет ли экземпляр модели сохранен после удаления файла, связанного с этим полем. По умолчанию True.

    Обратите внимание, что при удалении модели связанные файлы не удаляются. Если вам нужно очистить потерянные файлы, вам придется обрабатывать их самостоятельно (например, с помощью настраиваемой команды управления, которую можно запускать вручную или запускать по расписанию, например, через cron).


+ ```FilePathField```

    class FilePathField(path='', match=None, recursive=False, allow_files=True, allow_folders=False, max_length=100, **options)[исходный код]¶
    CharField, выбор которого ограничен именами файлов в определенном каталоге файловой системы. Имеет три специальных аргумента, первый из которых обязателен:

    ```FilePathField.path```

    Необходимые. Абсолютный путь файловой системы к каталогу, из которого FilePathField должен получить свой выбор. Пример: "/home/images".

    path также может вызываться, например, функция для динамического задания пути во время выполнения. Пример:
    ```
    import os
    from django.conf import settings
    from django.db import models

    def images_path():
        return os.path.join(settings.LOCAL_FILE_DIR, 'images')

    class MyModel(models.Model):
        file = models.FilePathField(path=images_path)
    ```

    ```FilePathField.match```
    По желанию. Регулярное выражение в виде строки, которое FilePathField будет использовать для фильтрации имен файлов. Обратите внимание, что регулярное выражение будет применяться к базовому имени файла, а не к полному пути. Пример: "foo.*\.txt$", который будет соответствовать файлу с именем foo23.txt, но не bar.txt или foo23.png.

    ```FilePathField.recursive```
    По желанию. Либо True, либо False. По умолчанию установлено значение False. Указывает, должны ли быть включены все подкаталоги path

    ```FilePathField.allow_files```
    По желанию. Либо True, либо False. По умолчанию установлено значение True. Указывает, следует ли включать файлы в указанном месте. Либо это, либо allow_folders должно быть True.

    ```FilePathField.allow_folders```
    По желанию. Либо True, либо False. По умолчанию установлено значение False. Указывает, следует ли включать папки в указанном месте. Либо это, либо allow_files должно быть True.

    Одна потенциальная ошибка заключается в том, что match применяется к базовому имени файла, а не к полному пути. Итак, этот пример

    ```FilePathField(path="/home/images", match="foo.*", recursive=True)```

    …будет соответствовать /home/images/foo.png, но не /home/images/foo/bar.png, потому что match применяется к базовому имени файла (foo.png и bar.png).

    : class: FilePathField экземпляры создаются в вашей базе данных как` varchar` столбцы с максимальной длиной по умолчанию 100 символов. Как и в других полях, вы можете изменить максимальную длину, используя аргумент: attr: ~ CharField.max_length.

+ ```FloatField```

    class FloatField(**options)

    Число с плавающей точкой, представленное в Python экземпляром float.
    Виджетом формы по умолчанию для этого поля является NumberInput, когда localize False или TextInput в противном случае.

    ```FloatField против DecimalField```

    Класс FloatField иногда сопоставляют с классом DecimalField. Хотя они оба представляют действительные числа, они представляют эти числа по-разному. FloatField использует внутри Python тип float, а DecimalField использует тип Decimal. Информацию о разнице между ними смотрите в документации Python для модуля decimal.

+ ```ImageField```

    class ImageField(upload_to=None, height_field=None, width_field=None, max_length=100, **options)

    Наследует все атрибуты и методы из FileField, но также проверяет, что загруженный объект является допустимым изображением.
    В дополнение к специальным атрибутам, которые доступны для FileField, ImageField также имеет атрибуты height и width.
    Чтобы упростить запросы к этим атрибутам, ImageField имеет два дополнительных необязательных аргумента:

    ```ImageField.height_field```
    
    Имя поля модели, которое будет автоматически заполняться высотой изображения при каждом сохранении экземпляра модели.

    ```ImageField.width_field```
    Имя поля модели, которое будет автоматически заполняться шириной изображения при каждом сохранении экземпляра модели.

    Требуется библиотека Pillow.
    Экземпляры ImageField создаются в вашей базе данных как varchar столбцы с максимальной длиной по умолчанию 100 символов. Как и в других полях, вы можете изменить максимальную длину, используя аргумент max_length.
    Виджетом формы по умолчанию для этого поля является ClearableFileInput.

+ ```IntegerField```

    class IntegerField(**options)

    Целое число. Значения от -2147483648 до 2147483647 безопасны во всех базах данных, поддерживаемых Django.
    Он использует MinValueValidator и MaxValueValidator для проверки ввода на основе значений, которые поддерживает база данных по умолчанию.
    Виджетом формы по умолчанию для этого поля является NumberInput, когда localize False или TextInput в противном случае.

+ ```GenericIPAddressField```

    class GenericIPAddressField(protocol='both', unpack_ipv4=False, **options)

    Адрес IPv4 или IPv6 в строковом формате (например, 192.0.2.30 или 2a02:42fe::4). Виджет формы по умолчанию для этого поля TextInput.
    Нормализация адресов IPv6 следует RFC 4291#section-2.2 разделу 2.2, включая использование формата IPv4, предложенного в параграфе 3 этого раздела, как ::ffff:192.0.2.0. Например, 2001:0::0:01 будет нормализован до 2001::1, а ::ffff:0a0a:0a0a до ::ffff:10.10.10.10. Все символы преобразуются в строчные.

    ```GenericIPAddressField.protocol```

    Ограничивает допустимый ввод для указанного протокола. Допустимые значения: 'both' (по умолчанию), 'IPv4' или 'IPv6'. Соответствие регистронезависимо.

    ```GenericIPAddressField.unpack_ipv4```
    
    Распаковывает сопоставленные адреса IPv4 как ::ffff:192.0.2.1. Если опция включена, то адрес будет распакован в 192.0.2.1. По умолчанию отключена. Может использоваться только в том случае, если protocol установлено в 'both'.

    Если вы разрешаете пустые значения, вы должны разрешить нулевые значения, так как пустые значения сохраняются как нулевые.

+ ```JSONField```

    class JSONField(encoder=None, decoder=None, **options)[исходный код]

    Поле для хранения данных в кодировке JSON. В Python данные представляются в родном для Python формате: словари, списки, строки, числа, булевы и None.

    JSONField поддерживается в MariaDB 10.2.7+, MySQL 5.7.8+, Oracle, PostgreSQL и SQLite (с Расширение JSON1 включено).

    ```JSONField.encoder```
    
    Необязательный подкласс json.JSONEncoder для сериализации типов данных, не поддерживаемых стандартным сериализатором JSON (например, datetime.datetime или UUID). Например, вы можете использовать класс DjangoJSONEncoder.
    По умолчанию используется json.JSONEncoder.

    ```JSONField.decoder```

    Необязательный подкласс json.JSONDecoder для десериализации значения, полученного из базы данных. Значение будет в формате, выбранном пользовательским кодировщиком (чаще всего это строка). Ваша десериализация, возможно, должна учитывать тот факт, что вы не можете быть уверены в типе ввода. Например, вы рискуете вернуть datetime, который на самом деле был строкой в том же формате, который выбран для datetime.
    По умолчанию используется json.JSONDencoder.

    Если вы задаете для поля default, убедитесь, что это неизменяемый объект, такой как str, или вызываемый объект, который каждый раз возвращает свежий изменяемый объект, такие как dict или функция. Предоставление изменяемого объекта по умолчанию, такого как default={} или default=[], разделяет один объект между всеми экземплярами модели.
    Чтобы запросить JSONField в базе данных, смотрите Запросы к JSONField.

    **Индексирование**

    Index и Field.db_index оба создают индекс B-дерева, который не особенно полезен при запросах к JSONField. Только в PostgreSQL вы можете использовать GinIndex, который лучше подходит.

    **Пользователи PostgreSQL**

    PostgreSQL имеет два собственных типа данных на основе JSON: json и jsonb. Основное различие между ними заключается в том, как они хранятся и как к ним можно обращаться. Поле json в PostgreSQL хранится как оригинальное строковое представление JSON и должно быть декодировано на лету при запросе на основе ключей. Поле jsonb хранится на основе фактической структуры JSON, что позволяет осуществлять индексирование. Компромиссом является небольшая дополнительная стоимость записи в поле jsonb. В JSONField используется jsonb.

    **Пользователи Oracle**

    База данных Oracle не поддерживает хранение скалярных значений JSON. Поддерживаются только объекты и массивы JSON (представленные в Python с использованием dict и list).


+ ```SmallAutoField```

    class SmallAutoField(**options)

    Подобно AutoField, но допускает только значения в определенном (зависящим от базы данных) диапазоном. Значения от 1 до 32767 безопасны во всех базах данных, поддерживаемых Django.

+ ```SmallIntegerField```

    class SmallIntegerField(**options)

    Подобно IntegerField, но допускает значения только в определенной (зависящей от базы данных) точке. Значения от -32768 до 32767 безопасны во всех базах данных, поддерживаемых Django.

+ ```TextField```

    class TextField(**options)
    
    Большое текстовое поле. Виджет формы по умолчанию для этого поля Textarea.
    Если вы укажете атрибут max_length, он будет отражен в виджете Textarea автоматически сгенерированного поля формы. Однако это не применяется на уровне модели или базы данных. Для этого используйте CharField.

    ```TextField.db_collation```

    New in Django 3.2.
    Имя поля сортировки базы данных.

    Примечание: Имена параметров сортировки не стандартизированы. Таким образом, это не будет переносимым между несколькими бэкэндами базы данных.

    Oracle не поддерживает параметры сортировки для TextField.

+ ```TimeField```

    class TimeField(auto_now=False, auto_now_add=False, **options)[исходный код]

    Время, представленное в Python экземпляром datetime.time. Принимает те же параметры автоматического заполнения, что и DateField.

    Виджет формы по умолчанию для этого поля TextInput. В админке добавляется несколько скриптов JavaScript.

+ ```URLField```

    class URLField(max_length=200, **options)[исходный код]

    CharField для URL, проверяется валидатором URLValidator.

    Виджет формы по умолчанию для этого поля TextInput.

    Как и все подклассы CharField, URLField принимает необязательный аргумент max_length. Если вы не укажете max_length, используется значение по умолчанию 200.

+ ```UUIDField```

    class UUIDField(**options)[исходный код]¶

    Поле для хранения универсально уникальных идентификаторов. Использует класс Python UUID. При использовании в PostgreSQL сохраняется в типе данных uuid, иначе в char(32).
    Универсально уникальные идентификаторы являются хорошей альтернативой AutoField для primary_key. База данных не будет генерировать UUID для вас, поэтому рекомендуется использовать default:

    ```
    import uuid
    from django.db import models

    class MyUUIDModel(models.Model):
        id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
        # other fields
    ```

    Обратите внимание, что вызываемый (без круглых скобок) передается в default, а не в экземпляр UUID.


### **Поля отношений**

Джанго также определяет набор полей, которые представляют отношения:

+ ```ForeignKey```

    class ForeignKey(to, on_delete, **options)
    
    Отношения многие-к-одному. Требуются два позиционных аргумента: класс, к которому относится модель, и опция on_delete.
    Чтобы создать рекурсивное отношение - объект, который имеет отношение «многие-к-одному» с самим собой - используйте models.ForeignKey('self', on_delete = models.CASCADE).
    Если вам нужно создать отношение на модель, которая еще не была определена, вы можете использовать имя модели, а не сам объект модели:

    ```
    from django.db import models

    class Car(models.Model):
        manufacturer = models.ForeignKey(
            'Manufacturer',
            on_delete=models.CASCADE,
        )
        # ...
    class Manufacturer(models.Model):
        # ...
        pass
    ```
    
    Отношения, определенные следующим образом абстрактные модели, разрешаются, когда модель подклассифицируется как конкретная модель, и не относятся к app_label абстрактной модели:

    ```
    products/models.py
    from django.db import models

    class AbstractCar(models.Model):
        manufacturer = models.ForeignKey('Manufacturer', on_delete=models.CASCADE)

        class Meta:
            abstract = True

    production/models.py
    from django.db import models
    from products.models import AbstractCar

    class Manufacturer(models.Model):
        pass

    class Car(AbstractCar):
        pass

    # Car.manufacturer will point to `production.Manufacturer` here.
    ```

    Для ссылки на модели, определенные в другом приложении, вы можете явно указать модель с полной меткой приложения. Например, если описанная выше модель Manufacturer определена в другом приложении под названием production, вам необходимо использовать:
    ```
    class Car(models.Model):
    manufacturer = models.ForeignKey(
        'production.Manufacturer',
        on_delete=models.CASCADE,
    )
    ```

    Такого рода ссылки, называемые ленивыми отношениями, могут быть полезны при разрешении циклических зависимостей импорта между двумя приложениями.
    Индекс базы данных автоматически создается для ForeignKey. Вы можете отключить это, установив db_index в False. Возможно, вы захотите избежать накладных расходов на индекс, если вы создаете внешний ключ для согласованности, а не для объединений, или если вы будете создавать альтернативный индекс, такой как индекс с частичным или множественным столбцом.

    Представление базы данных
    За кулисами Django добавляет "_id" к имени поля, чтобы создать имя столбца базы данных. В приведенном выше примере таблица базы данных для модели Car будет иметь столбец factory_id. (Вы можете изменить это явно, указав db_column). Однако ваш код никогда не должен иметь дело с именем столбца базы данных, если вы не пишете пользовательский SQL. Вы всегда будете иметь дело с именами полей вашего модельного объекта.

    **Аргументы**

    ForeignKey принимает другие аргументы, которые определяют детали работы отношений.

    ```ForeignKey.on_delete```

    При удалении объекта, на который ссылается ForeignKey, Django будет эмулировать поведение ограничения SQL, заданного аргументом on_delete. Например, если у вас есть обнуляемым ForeignKey и вы хотите, чтобы он был установлен в null, когда ссылочный объект удален:

    ```
    user = models.ForeignKey(
        User,
        models.SET_NULL,
        blank=True,
        null=True,
    )
    ```

    on_delete не создает ограничение SQL в базе данных. Поддержка опций каскадного уровня базы данных может быть реализовано позже.
    Возможные значения для on_delete находятся в django.db.models:



     ```CASCADE```

    Каскадное удаление. Django эмулирует поведение ограничения SQL ON DELETE CASCADE, а также удаляет объект, содержащий ForeignKey.
    Model.delete() не вызывается в связанных моделях, но сигналы pre_delete и post_delete отправляются для всех удаленных объектов.

     ```PROTECT```

    Предотвращает удаление объекта, на который есть ссылка, путем вызова ProtectedError, подкласса django.db.IntegrityError.

     ```RESTRICT```

    Предотвращает удаление указанного объекта путем вызова RestrictedError (подкласс django.db.IntegrityError). В отличие от PROTECT, удаление ссылочного объекта допускается, если он также ссылается на другой объект, который удаляется в той же операции, но через отношение CASCADE.

    Рассмотрим этот набор моделей:

    ```
    class Artist(models.Model):
        name = models.CharField(max_length=10)

    class Album(models.Model):
        artist = models.ForeignKey(Artist, on_delete=models.CASCADE)

    class Song(models.Model):
        artist = models.ForeignKey(Artist, on_delete=models.CASCADE)
        album = models.ForeignKey(Album, on_delete=models.RESTRICT)
    ```

    Artist можно удалить, даже если это подразумевает удаление Album, на который ссылается Song, потому что Song также ссылается на Artist через каскадные отношения. Например:

    ```
    >>> artist_one = Artist.objects.create(name='artist one')
    >>> artist_two = Artist.objects.create(name='artist two')
    >>> album_one = Album.objects.create(artist=artist_one)
    >>> album_two = Album.objects.create(artist=artist_two)
    >>> song_one = Song.objects.create(artist=artist_one, album=album_one)
    >>> song_two = Song.objects.create(artist=artist_one, album=album_two)
    >>> album_one.delete()
    # Raises RestrictedError.
    >>> artist_two.delete()
    # Raises RestrictedError.
    >>> artist_one.delete()
    (4, {'Song': 2, 'Album': 1, 'Artist': 1})
    ```

     ```SET_NULL```

    Устанавливает ForeignKey null; это возможно только в том случае, если null равно True.

    ```SET_DEFAULT```

    Устанавливает для ForeignKey значение по умолчанию; значение по умолчанию для ForeignKey должно быть указано в описании поля.

    ```SET()```

    Устанавливает для ForeignKey значение, переданное в :func:"~django.db.models.SET() ", или, если передан вызываемый объект, результат его вызова. В большинстве случаев передача вызываемого будет необходима, чтобы избежать выполнения запросов во время импорта вашего models.py:

    ```
    from django.conf import settings
    from django.contrib.auth import get_user_model
    from django.db import models

    def get_sentinel_user():
        return get_user_model().objects.get_or_create(username='deleted')[0]

    class MyModel(models.Model):
        user = models.ForeignKey(
            settings.AUTH_USER_MODEL,
            on_delete=models.SET(get_sentinel_user),
        )
    ```

    ```DO_NOTHING```

    Не предпринимает никаких действий. Если ваша база данных обеспечивает ссылочную целостность, это вызовет IntegrityError, если вы вручную не добавите ограничение SQL ON DELETE в поле базы данных.

    ```ForeignKey.limit_choices_to```

    Устанавливает ограничение на доступные варианты выбора для этого поля, когда это поле отображается с помощью ModelForm или в админке (по умолчанию все объекты в наборе запросов доступны для выбора). Можно использовать словарь, объект Q или вызываемый объект, возвращающий словарь или объект Q.

    **Например:**
    
    ```
    staff_member = models.ForeignKey(
        User,
        on_delete=models.CASCADE,
        limit_choices_to={'is_staff': True},
    )
    ```

    заставляет соответствующее поле в ModelForm перечислять только Users, которые имеют is_staff=True. Это может быть полезно в админке Django.
    Вызываемая форма может быть полезна, например, при использовании совместно с модулем Python datetime для ограничения выбора по диапазону дат. 

    **Например:**

    ```
    def limit_pub_date_choices():
        return {'pub_date__lte': datetime.date.today()}

    limit_choices_to = limit_pub_date_choices
    ```

    Если limit_choices_to равно или возвращает Q объект, который полезен для сложных запросов, тогда он будет влиять только на варианты, доступные в админке, если поле не указано в raw_id_fields в ModelAdmin для модели.

    **Примечание**

    Если для limit_choices_to используется вызываемый объект, он будет вызываться каждый раз, когда создается новая форма. Он также может быть вызван при проверке модели, например, командами управления или в админке. Админка создает наборы запросов для проверки входных данных своей формы в различных крайних случаях несколько раз, поэтому существует вероятность, что ваш вызываемый объект может быть вызван несколько раз.

    ```ForeignKey.related_name```
    
    Имя, используемое для отношения от связанного объекта обратно к нему. Это также значение по умолчанию для related_query_name (имя, используемое для имени обратного фильтра из целевой модели). Смотрите документацию по связанным объектам для полного объяснения и примера. Обратите внимание, что вы должны установить это значение при определении отношений абстрактных моделей; и когда вы делаете это, то доступен специальный синтаксис.
    Если вы предпочитаете, чтобы Django не создавал обратную связь, установите для related_name значение '+' или завершите его с помощью '+'. Например, это гарантирует, что модель User не будет иметь обратной связи с этой моделью:

    ```user = models.ForeignKey(
        User,
        on_delete=models.CASCADE,
        related_name='+',
    )
    ```

    ```ForeignKey.related_query_name```

    Имя, используемое для обратного имени фильтра из целевой модели. По умолчанию используется значение related_name или default_related_name, если установлено, в противном случае по умолчанию используется имя модели:

    ```
    # Declare the ForeignKey with related_query_name
    class Tag(models.Model):
        article = models.ForeignKey(
            Article,
            on_delete=models.CASCADE,
            related_name="tags",
            related_query_name="tag",
        )
        name = models.CharField(max_length=255)

    # That's now the name of the reverse filter
    Article.objects.filter(tag__name="important")
    ```

    Например related_name, related_query_name поддерживает интерполяцию меток приложения и классов посредством специального синтаксиса.

    ```ForeignKey.to_field```

    Поле связанного объекта, к которому относится отношение. По умолчанию Django использует первичный ключ связанного объекта. Если вы ссылаетесь на другое поле, это поле должно иметь unique=True.

    ```ForeignKey.db_constraint```

    Определяет, следует ли создать ограничение в базе данных для этого внешнего ключа. По умолчанию используется True, и это почти наверняка то, что вы хотите; установка этого значения в False может быть очень плохой для целостности данных. Тем не менее, вот несколько сценариев, где вы можете сделать это:

    У вас есть устаревшие данные, которые не действительны.
    Вы разделяете свою базу данных.
    Если для этого параметра установлено значение False, доступ к связанному объекту, который не существует, вызовет исключение DoesNotExist.

    ```ForeignKey.swappable```

    Управляет реакцией фреймворка миграций, если этот ForeignKey указывает на заменяемую модель. Если это True - по умолчанию - тогда, если ForeignKey указывает на модель, которая соответствует текущему значению settings.AUTH_USER_MODEL (или другой сменной настройке модели), связь будет хранится в миграции с использованием ссылки на настройку, а не на модель напрямую.

    Установка этого значения в False не означает, что вы можете ссылаться на заменяемую модель, даже если она поменяна местами - False означает, что миграции, выполненные с помощью этого ForeignKey, всегда будут ссылаться на указанную вами точную модель (так что это не удастся легко сломать, если пользователь пытается запустить с моделью User, которую вы не поддерживаете, например).
    Если сомневаетесь, оставьте для него значение по умолчанию True.

+ ```ManyToManyField```

    class ManyToManyField(to, **options)

    Отношения многие ко многим. Требуется позиционный аргумент: класс, к которому относится модель, который работает точно так же, как и для ForeignKey, включая рекурсивные отношения.
    Связанные объекты можно добавлять, удалять или создавать с помощью поля RelatedManager.

    Представление базы данных:

    За кулисами Django создает промежуточную таблицу соединений для представления отношения «многие ко многим». По умолчанию это имя таблицы генерируется с использованием имени поля «многие ко многим» и имени таблицы для модели, в которой оно содержится. Поскольку некоторые базы данных не поддерживают имена таблиц выше определенной длины, эти имена таблиц будут автоматически усечены, и будет использован хеш уникальности, например, Author_books_9cdf. Вы можете вручную указать имя объединяемой таблицы с помощью параметра db_table.

    Аргументы
    ManyToManyField принимает дополнительный набор аргументов - все необязательные - которые управляют работой отношений.

    ```ManyToManyField.related_name```

    То же, что ForeignKey.related_name.

    ```ManyToManyField.related_query_name```

    То же, что ForeignKey.related_query_name.

    ```ManyToManyField.limit_choices_to```

    То же, что ForeignKey.limit_choices_to.

    ```ManyToManyField.symmetrical```

    Используется только в определении ManyToManyFields на самого себя. Рассмотрим следующую модель:

    ``` 
   from django.db import models

    class Person(models.Model):
        friends = models.ManyToManyField("self")
    ```

    Когда Django обрабатывает эту модель, он идентифицирует, что у него есть ManyToManyField, и в результате он не добавляет атрибут person_set к классу Person. Вместо этого предполагается, что ManyToManyField является симметричным, то есть, если я ваш друг, то вы мой друг.
    Если вам не нужна симметрия в отношениях «многие ко многим» с self, установите symmetrical в False. Это заставит Django добавить дескриптор для обратной связи, что сделает отношения ManyToManyField несимметричными.

    ```ManyToManyField.through```

    Django автоматически создаст таблицу для управления отношениями «многие ко многим». Однако, если вы хотите указать промежуточную таблицу вручную, вы можете использовать опцию through, чтобы указать модель Django, представляющую промежуточную таблицу, которую вы хотите использовать.

    Чаще всего этот параметр используется, когда вы хотите связать дополнительные данные с отношением «многие ко многим».

    **Примечание**

    Если вам не нужны множественные ассоциации между одними и теми же экземплярами, добавьте UniqueConstraint, включая поля from и to. Автоматически создаваемые в Django таблицы «многие ко многим» включают такое ограничение.

    **Примечание**

    Рекурсивные отношения, использующие промежуточную модель, не могут определять имена обратных методов доступа, поскольку они будут одинаковыми. Вам нужно установить related_name хотя бы для одного из них. Если вы предпочитаете, чтобы Django не создавал обратную связь, установите для related_name значение '+'.
    Если вы не укажете явную модель through, все еще существует неявный класс модели through, который вы можете использовать для прямого доступа к таблице, созданной для хранения ассоциации. Он имеет три поля для связи моделей.
    Если исходная и целевая модели различаются, создаются следующие поля:

    id: первичный ключ отношения.
    <containing_model>_id: id модели, которая объявляет ManyToManyField.
    <other_model>_id: `` id`` модели, на которую указывает `` ManyToManyField``.
    Если ManyToManyField указывает на одну и ту же модель, генерируются следующие поля:
    
        id: первичный ключ отношения.
        from_<model>_id: `` id`` экземпляра, который указывает на модель (то есть исходный экземпляр).
        to_<model>_id: `` id`` экземпляра, на который указывает отношение (то есть экземпляр целевой модели).
        Этот класс может использоваться для запроса связанных записей для данного экземпляра модели, как обычная модель:
    

    ```Model.m2mfield.through.objects.all()```

    ```ManyToManyField.through_fields```

    Используется только когда указана пользовательская промежуточная модель. Django обычно определяет, какие поля промежуточной модели использовать для автоматического установления отношения «многие ко многим». Однако рассмотрим следующие модели:

    ```
    from django.db import models

    class Person(models.Model):
        name = models.CharField(max_length=50)

    class Group(models.Model):
        name = models.CharField(max_length=128)
        members = models.ManyToManyField(
            Person,
            through='Membership',
            through_fields=('group', 'person'),
        )

    class Membership(models.Model):
        group = models.ForeignKey(Group, on_delete=models.CASCADE)
        person = models.ForeignKey(Person, on_delete=models.CASCADE)
        inviter = models.ForeignKey(
            Person,
            on_delete=models.CASCADE,
            related_name="membership_invites",
        )
        invite_reason = models.CharField(max_length=64)
    ```


    Membership имеет два внешних ключа для Person (person и inviter), что делает отношения неоднозначными, и Django не может знать, какой из них использовать. В этом случае вы должны явно указать, какие внешние ключи должен использовать Django, используя through_fields, как в примере выше.

    through_fields принимает 2-х значный кортеж ('field1', 'field2'), где field1 - имя внешнего ключа модели, для которого определен класс ManyToManyField (group в данном случае) и field2 - имя внешнего ключа для целевой модели (в данном случае person).
    Если у вас есть более одного внешнего ключа в промежуточной модели для любой (или даже обеих) моделей, участвующих в отношении многие-ко-многим, вы должны указать through_fields. Это также относится к :ref: рекурсивным отношениям <recursive-relationships>, когда используется модель-посредник и существует более двух внешних ключей для модели, или вы хотите явно указать, какие два Django следует использовать.

    ```ManyToManyField.db_table```

    Имя таблицы, создаваемой для хранения данных «многие ко многим». Если это не предусмотрено, Django примет имя по умолчанию на основе имен: таблицы для модели, определяющей отношение, и имени самого поля.

    ```ManyToManyField.db_constraint```

    Определяет, следует ли создавать ограничения в базе данных для внешних ключей в промежуточной таблице. По умолчанию используется True, и это почти наверняка то, что вы хотите; установка этого значения в False может быть очень плохой для целостности данных. Тем не менее, вот несколько сценариев, где вы можете сделать это:

    У вас есть устаревшие данные, которые не действительны.
    Вы разделяете свою базу данных.
    Будет ошибкой пропускать оба параметра: db_constraint и through.

    ```ManyToManyField.swappable```

    Управляет реакцией фреймворка миграции, если этот ManyToManyField указывает на заменяемую модель. Если True - по умолчанию - тогда, если ManyToManyField указывает на модель, которая соответствует текущему значению settings.AUTH_USER_MODEL (или другой сменной настройки модели), отношение будет хранится в миграции с использованием ссылки на настройку, а не на модель напрямую.

    You only want to override this to be False if you are sure your model should always point toward the swapped-in model - for example, if it is a profile model designed specifically for your custom user model.

    Если сомневаетесь, оставьте для него значение по умолчанию True.

    ManyToManyField не поддерживает validators.

    null не имеет никакого эффекта, поскольку нет способа требовать отношений на уровне базы данных.

+ ```OneToOneField```

    class OneToOneField(to, on_delete, parent_link=False, **options)

    Отношения один-к-одному. Концептуально это похоже на ForeignKey с ```:attr:'unique=True <Field.unique> '```, но «обратная» сторона отношения будет напрямую возвращать один объект.
    Это наиболее полезно в качестве первичного ключа модели, которая каким-то образом «расширяет» другую модель; Мультитабличное наследование реализуется путем добавления неявного отношения один-к-одному из дочерней модели, например, в родительскую модель.
    Требуется один позиционный аргумент: класс, с которым будет связана модель. Это работает точно так же, как и для ForeignKey, включая все параметры, относящиеся к рекурсивным и ленивым отношениям.
    Если вы не укажете аргумент related_name для OneToOneField, Django будет использовать имя текущей модели в нижнем регистре в качестве значения по умолчанию.

    Со следующим примером:

    ``` 
    from django.conf import settings
    from django.db import models

    class MySpecialUser(models.Model):
        user = models.OneToOneField(
            settings.AUTH_USER_MODEL,
            on_delete=models.CASCADE,
        )
        supervisor = models.OneToOneField(
            settings.AUTH_USER_MODEL,
            on_delete=models.CASCADE,
            related_name='supervisor_of',
        )
    ```

    ваша итоговая модель User будет иметь следующие атрибуты:

    ```
    >>> user = User.objects.get(pk=1)
    >>> hasattr(user, 'myspecialuser')
    True
    >>> hasattr(user, 'supervisor_of')
    True
    ```

    Исключение RelatedObjectDoesNotExist возникает при доступе к обратной связи, если запись в связанной таблице не существует. Это подкласс исключения целевой модели Model.DoesNotExist. Например, если у пользователя нет супервизора, назначенного MySpecialUser:

    ```
    >>> user.supervisor_of
    Traceback (most recent call last):
        ...
    ```

    RelatedObjectDoesNotExist: User has no supervisor_of.
    Кроме того, OneToOneField принимает все дополнительные аргументы, принятые ForeignKey, плюс один дополнительный аргумент:

    ```OneToOneField.parent_link```
    
    Когда True и используется в модели, которая наследуется от другого concrete model, указывает, что это поле следует использовать как ссылку на родительский класс, а не как дополнительное OneToOneField, которое обычно неявно создается путем создания подклассов.


    После создания моделей их нужно записать в файл миграции

___
## **Работа с миграциями.**

Миграции нужны для связи проекта с базой данных.

python manage.py makemigrations - Файлы миграций можно писать вручную, но это долго, сложно и легко ошибиться. Для создания миграций автоматически в Django есть команда python manage.py makemigrations. Если миграций ещё не было, то эта команда создаст файл 0001_initial.py в папке migrations, где она опишет все модели для базы данных.
Если вы уже проводили миграции в своём проекте, то Django сравнит текущий файл models.py с историей миграций. Django сама определит, что нужно убрать из моделей, а что — добавить, чтобы отмигрировать базу данных к новым моделям.
python manage.py migrate - запускает миграции в базе данных.
python manage.py showmigrations - покажет список миграций и их статус.




## **Полезные ссылки.**

+ https://developer.mozilla.org/ru/docs/Learn/Server-side/Django - Руководство по Django от mozilla

+ https://www.youtube.com/playlist?list=PLDyJYA6aTY1nZ9fSGcsK4wqeu-xaJksQQ - Неплохие видеоуроки по Django3 от itProger


